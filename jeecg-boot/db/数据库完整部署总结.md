# æ™ºèƒ½ç•œç‰§ç®¡ç†ç³»ç»Ÿ - æ•°æ®åº“å®Œæ•´éƒ¨ç½²æ€»ç»“

## ğŸ¯ éƒ¨ç½²å®ŒæˆçŠ¶æ€

âœ… **MySQLä¸šåŠ¡æ•°æ®åº“**: å·²å®Œæˆæ ¸å¿ƒè¡¨ç»“æ„åˆ›å»ºå’ŒåŸºç¡€æµ‹è¯•æ•°æ®  
âœ… **TDengineæ—¶åºæ•°æ®åº“**: å·²å®Œæˆè¶…çº§è¡¨åˆ›å»ºå’Œå†å²é¥æµ‹æ•°æ®  
âœ… **æ•°æ®åŒæ­¥æœºåˆ¶**: å·²å»ºç«‹MySQLä¸TDengineçš„æ•°æ®æ˜ å°„å…³ç³»

## ğŸ“Š æ•°æ®åº“æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL (ä¸šåŠ¡åº“)    â”‚     â”‚ TDengine (æ—¶åºåº“)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ah_animal (æ¡£æ¡ˆ)    â”‚ â†â†’  â”‚ telemetry_data      â”‚
â”‚ ah_device (è®¾å¤‡)    â”‚     â”‚ (å†å²é¥æµ‹æ•°æ®)      â”‚
â”‚ ah_telemetry_latest â”‚     â”‚                     â”‚
â”‚ (æœ€æ–°æ•°æ®å¿«ç…§)      â”‚     â”‚ 85æ¡å†å²è®°å½•        â”‚
â”‚                     â”‚     â”‚ 5ä¸ªè®¾å¤‡å­è¡¨         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—‚ï¸ å·²åˆ›å»ºçš„è„šæœ¬æ–‡ä»¶

### MySQLè„šæœ¬
1. `æ™ºèƒ½ç•œç‰§å¹³å°/animal_husbandry_tables.sql` - æ ¸å¿ƒè¡¨ç»“æ„+åŸºç¡€æ•°æ®
2. `jeecg-boot/db/è®¾å¤‡ç›‘æ§æµ‹è¯•æ•°æ®è¡¥å…….sql` - å¢å¼ºæµ‹è¯•æ•°æ®
3. `jeecg-boot/db/MySQLæ›´æ–°æœ€æ–°é¥æµ‹æ•°æ®.sql` - æœ€æ–°æ•°æ®å¿«ç…§åŒæ­¥
4. `jeecg-boot/db/æ›´æ–°MySQLè®¾å¤‡çŠ¶æ€.sql` - è®¾å¤‡çŠ¶æ€æ›´æ–°

### TDengineè„šæœ¬
1. `jeecg-boot/db/TDengine_v3_å»ºè¡¨.sql` - è¶…çº§è¡¨å’Œå­è¡¨åˆ›å»º
2. `jeecg-boot/db/TDengine_v3_æµ‹è¯•æ•°æ®.sql` - å†å²é¥æµ‹æ•°æ®
3. `jeecg-boot/db/TDengineæ‰§è¡ŒæŒ‡å—.md` - æ“ä½œæŒ‡å—

## ğŸ“ˆ æµ‹è¯•æ•°æ®å®Œæ•´æ€§

### è®¾å¤‡æ•°æ®åˆ†å¸ƒ
| è®¾å¤‡ID | ç±»å‹ | çŠ¶æ€ | è®°å½•æ•° | ç‰¹ç‚¹ |
|--------|------|------|--------|------|
| DEV-CAP-001 | ç˜¤èƒƒèƒ¶å›Š | æ­£å¸¸ | 20æ¡ | ä½“æ¸©38.2-39.2â„ƒ |
| DEV-CAP-002 | ç˜¤èƒƒèƒ¶å›Š | å‘Šè­¦ | 20æ¡ | é«˜ä½“æ¸©39.5-40.5â„ƒ |
| DEV-CAP-003 | ç˜¤èƒƒèƒ¶å›Š | æœªç»‘å®š | 5æ¡ | åº“å­˜çŠ¶æ€ |
| DEV-TRK-001 | è¿½è¸ªå™¨ | æ­£å¸¸ | 20æ¡ | GPSæ­£å¸¸ï¼Œç”µé‡å……è¶³ |
| DEV-TRK-002 | è¿½è¸ªå™¨ | ä½ç”µé‡ | 20æ¡ | ç”µé‡6%-25% |

### ç‰²ç•œç»‘å®šå…³ç³»
| ç‰²ç•œID | è€³æ ‡ | ç»‘å®šè®¾å¤‡ | å¥åº·çŠ¶æ€ |
|--------|------|----------|----------|
| ANIMAL-001 | EAR-001 | DEV-TRK-001 | å¥åº· |
| ANIMAL-002 | EAR-002 | DEV-CAP-001 + DEV-TRK-002 | äºšå¥åº· |
| ANIMAL-003 | EAR-003 | DEV-CAP-002 | å‘Šè­¦ |
| ANIMAL-004 | EAR-004 | æ— è®¾å¤‡ | å¥åº· |

## ğŸš€ ä¸‹ä¸€æ­¥éƒ¨ç½²å»ºè®®

### 1. æ‰§è¡ŒMySQLæ•°æ®åŒæ­¥
```bash
# åœ¨MySQLä¸­æ‰§è¡Œ
source jeecg-boot/db/MySQLæ›´æ–°æœ€æ–°é¥æµ‹æ•°æ®.sql;
source jeecg-boot/db/æ›´æ–°MySQLè®¾å¤‡çŠ¶æ€.sql;
```

### 2. éªŒè¯æ•°æ®å®Œæ•´æ€§
```sql
-- MySQLéªŒè¯
SELECT COUNT(*) FROM ah_telemetry_latest; -- åº”è¯¥è¿”å›5æ¡
SELECT COUNT(*) FROM ah_animal; -- åº”è¯¥è¿”å›4æ¡
SELECT COUNT(*) FROM ah_device; -- åº”è¯¥è¿”å›5æ¡

-- TDengineéªŒè¯
SELECT COUNT(*) FROM telemetry_data; -- åº”è¯¥è¿”å›85æ¡
```

### 3. å¼€å‘Javaè¿æ¥ç»„ä»¶

#### TDengineè¿æ¥é…ç½®
```yaml
# application.yml
spring:
  datasource:
    tdengine:
      driver-class-name: com.taosdata.jdbc.TSDBDriver
      url: jdbc:TAOS://172.22.2.120:6030/animal_husbandry
      username: root
      password: taosdata
```

#### å…³é”®æŸ¥è¯¢æ¥å£
```java
// è·å–è®¾å¤‡å†å²æ•°æ® (ç”¨äºå›¾è¡¨)
SELECT ts, temperature, activity_level 
FROM telemetry_dev_cap_001 
WHERE ts >= ? AND ts <= ? 
ORDER BY ts;

// è·å–æœ€æ–°çŠ¶æ€èšåˆ
SELECT device_id, LAST(*) 
FROM telemetry_data 
GROUP BY device_id;
```

## ğŸ”§ ç³»ç»Ÿç›‘æ§å»ºè®®

### æ€§èƒ½æŒ‡æ ‡
- TDengineæŸ¥è¯¢å“åº”æ—¶é—´ < 100ms
- MySQLä¸šåŠ¡æŸ¥è¯¢å“åº”æ—¶é—´ < 50ms
- æ•°æ®åŒæ­¥å»¶è¿Ÿ < 5ç§’

### æ•°æ®è´¨é‡æ£€æŸ¥
```sql
-- æ£€æŸ¥æ•°æ®æ—¶æ•ˆæ€§ (æœ€æ–°æ•°æ®ä¸è¶…è¿‡1å°æ—¶)
SELECT device_id, LAST(ts) as last_time
FROM telemetry_data 
GROUP BY device_id 
HAVING LAST(ts) < NOW() - INTERVAL 1 HOUR;

-- æ£€æŸ¥å¼‚å¸¸æ•°æ®
SELECT COUNT(*) FROM telemetry_data 
WHERE temperature > 45 OR temperature < 35;
```

## ğŸ“‹ æ•…éšœæ’æŸ¥æ¸…å•

### å¸¸è§é—®é¢˜
1. **TDengineè¿æ¥å¤±è´¥**: æ£€æŸ¥ç«¯å£6030å’Œé˜²ç«å¢™
2. **MySQLåŒæ­¥å»¶è¿Ÿ**: æ£€æŸ¥ah_telemetry_latestè¡¨ç´¢å¼•
3. **æ•°æ®ä¸ä¸€è‡´**: è¿è¡Œæ•°æ®æ ¡éªŒè„šæœ¬

### å¤‡ä»½ç­–ç•¥
```bash
# TDengineå¤‡ä»½
taosdump -h 172.22.2.120 -D animal_husbandry -o backup/

# MySQLå¤‡ä»½
mysqldump animal_husbandry ah_* > backup_mysql.sql
```

## ğŸ‰ éƒ¨ç½²æˆåŠŸéªŒè¯

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹æŸ¥è¯¢ç»“æœæ—¶ï¼Œè¯´æ˜éƒ¨ç½²å®Œå…¨æˆåŠŸï¼š

```sql
-- TDengine
taos> SELECT COUNT(*) FROM telemetry_data;
-- ç»“æœ: 85

-- MySQL  
mysql> SELECT device_id, JSON_EXTRACT(telemetry_data, '$.temperature') 
       FROM ah_telemetry_latest WHERE device_id LIKE '%CAP%';
-- ç»“æœ: æ˜¾ç¤º3ä¸ªç˜¤èƒƒèƒ¶å›Šçš„æœ€æ–°ä½“æ¸©æ•°æ®
```

æ­å–œï¼æ‚¨ç°åœ¨æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§å°±ç»ªçš„æ™ºèƒ½ç•œç‰§ç®¡ç†ç³»ç»Ÿæ•°æ®åº“æ¶æ„ï¼ 